<!-- prettier-ignore -->
{% extends 'base.html' %} 
{% load crispy_forms_tags %} 
{% block title %} calculate distance {% endblock title%}
{% block content %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<!-- Modal -->
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          Distance to {{ destination }} is:
        </h5>

        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">{{ distance }} km</div>
    </div>
  </div>
</div>

{{ map|safe }}

<button
  type="button"
  id="pop-btn"
  class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
>
  Info
</button>
<div class="container mx-auto">
  <h2 id="castle-name">castle_id</h2>
</div>

<form action="" method="POST" autocomplete="off">
  {% csrf_token %} {{form|crispy}}
  <button type="submit" class="btn btn-primary">Confirm</button>
</form>
<div>
  <ul>
    <!-- prettier-ignore -->
    {% comment %} {% for result in castles %}
    <li>{{result}}</li>
    {% endfor %} {% endcomment %}
  </ul>
</div>
<br />
This product includes GeoLite2 data created by MaxMind, available from
<a href="https://www.maxmind.com">https://www.maxmind.com</a>.
<!-- prettier-ignore -->
{% comment %} {% if request.POST and distance is not None %} {% endcomment %}
<script>
  {% comment %} $(window).on('load', function () {
    $('#exampleModal').modal('show');
  }); {% endcomment %}

  $(document).ready(function () {
      var info = $('iframe').contents();
      var popUp = info["0"]["body"]["firstElementChild"]["firstChild"]["children"]["5"]
      console.log(popUp);

    $('#pop-btn').click(function () {
      console.log(popUp);
      if(popUp["firstChild"] !== null) {
        var name = popUp["firstChild"]["firstChild"]["firstChild"]["firstChild"]["firstChild"]
        castle_id = name["id"]
        $('#castle-name').text(castle_id);
      }
    });
  });
</script>
{% comment %} {% endif %} {% endcomment %}
<!-- prettier-ignore -->
{% endblock content %}
